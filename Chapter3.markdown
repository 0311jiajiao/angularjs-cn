#AngularJS开发

现在, 我们已经探究了组成AngularJS的一些轮子. 我们已经知道用户进入我们的应用程序后如何获取数据, 如何显示文本, 以及如何做一些时髦的验证, 过滤和改变DOM. 但是我们要如何把它们组织在一起呢?

在本章, 我们将讨论以下内容:

+ 如何适应快速开发布局AngularJS应用程序
+ 启动服务器查看应用程序行为
+ 使用Karma编写和运行单元测试和场景测试
+ 针对产品部署编译和压缩你的AngularJS应用程序
+ 使用Batarang调试你的AngularJS应用程序
+ 简化开发流程(从创建文件到运行应用程序和测试)
+ 使用依赖管理库RequireJS整合AnguarJS项目

本章旨在提供一个20000英尺的视图以告诉你如何可行的布局你的AngularJS应用程序. 我们不会进入实际应用程序本身. 在第4章, 深入一个使用和展示了各种各样AngularJS特性的示例一用程序.

##项目组织

推荐使用Yeoman构建你的项目, 将会为你的AngularJS应用程序创建所有必要的辅助程序文件.

Yeoman是一个包含多个框架和客户端库的强大的工具. 它通过自动化一些日常任务的引导的方式提供了一个快速的开发环境和增强你的应用程序. 本章我们会使用一个完整的小节介绍如何安装和使用Yeoman, 但是在那之前, 我们先来简单的介绍以下使用Yeoman命令替代那些手动执行的操作.

我们还详细介绍了涉及到让你决定不使用Yeoman的情况, 因为在Windows平台的计算机上Yeoman确实存在一些问题, 并且设置它还稍微有一点挑战性.

对于那些不使用Yeoman的情况, 我们将会看看一个示例应用程序结构(可以在Github示例仓库的`chapter3/sample-app`目录中找到 - [链接](https://github.com/shyamseshadri/angularjs-book/tree/master/chapter3/sample-app)), 下面是推荐的结构, 也是使用Yeoman生成的结构. 应用程序的文件可以分为以下类别:

**JS源文件**

看看`app/scripts`目录. 这里是你所有的JS源文件所在目录. 一个主文件来给你的应用程序设置Angular模块和路由.

此外, 这里还有一个单独的文件夹--`app/scripts/controller`--这里面是各个控制器. 控制器提供行为和发布数据到作用域中, 然后显示在视图中. 通常, 它们与视图都是一一对应的.

指令, 过滤器和服务也可以在`app/scripts`下面找到, 不管是否优雅和复杂, 作为一个完整的文件(direcyives.js, filters.js, services.js)或者单个的都行.

**Angular HTML模板文件**

现在, 使用Yeoman创建的每一个AngularJS局部模板都可以在`app/views`目录中找到. 这是映射到大多数`app/scripts/controller`目录中.

还有另外一个重要的Angular模板文件, 就是主要的`app/index.html`. 这用户获取AngularJS源文件, 也是你为应用程序创建的任意源文件.

如果你最终会创建一个新的JS文件, 要确保把它添加到`index.html`中, 同时还要更新的主模块和路由(Yeoman也会为你做这些).

**JS库依赖**

Yeoman在`app/scripts/vendor`中为你提供了所有的JS源文件依赖. 想在应用程序中使用[Underscore](http://underscorejs.org/)和[SocketIO](http://socket.io/)? 没问题--将依赖添加到vendor目录中(还有你的`index.html`), 并开始在你的用用程序中引用它.

**静态资源**

最终你创建了一个HTML应用程序, 它还会考虑到你的应用程序还有作为需要的CSS和图像依赖. `app/styles`和`app/img`目录就是出于这个目的而产生的. 你只需要添加你需要的东西到目录中并在你的应用程序中引用它们(当然, 要使用正确的绝对路径).

> 默认情况下Yeoman不会创建`app/img`路径.

**单元测试**

测试是非常重要的, 并且当它涉及到AngularJS时是毫不费力的. 在测试方面`test/spec`目录应该映射到你的`app/scripts`目录. 每个文件都应该有一个包含它的单元测试的spec文件映射(镜像). 种子文件会给每个控制器文件创建一个存根文件, 在`test/spec/controllers`目录下, 与原来的控制器具有相同的名称. 它们都是Jasmine风格的规范, 描述了每个控制器预期行为的规范.

**集成测试**

AngularJS自带了端对端的测试支持以正确的方式内置到库里面. 你所有的Jasmine规范形式的E2E(端对端)测试, 都保存在`tests/e2e`目录下.

> 默认情况下Yeoman不会创建`test/目录`.

> 虽然E2E测试可能看起来像Jasmine, 但实际上不是的. 它们的函数是异步执行的, 来未来, 可以通过Angular场景运行器(Angular Scenario Runner)运行. 因此不要指望能够做正常情况下Jasmine测试所做的事情(像使用console.log重复输出一个值的情况).

还生成了一个简单的HTML文件, 可以在浏览器中打开它来手动的运行测试. 然而Yeoman不会生成存根文件, 但是它们遵循相似风格的单元测试.

**配置文件**

这里需要两个配置文件. 第一个是`karma.conf.js`, 这是Yeoman为你生成的用于运行单元测试的. 第二个, 是Yeoman不会生成的`karma.e2e.conf.js`. 这用于运行场景测试. 在本场尾部的继承RequireJS一节中有一个简单的文件. 这用于配置依赖关系的详情, 同时这个文件用在你使用karma运行单元测试的时候.

你可能会问: 如何运行我的应用程序? 什么是单元测试? 甚至我该如何编写你们所讨论的这种各样的零件?

别担心, 年轻的蚱蜢, 所有的这些在适当的时间都会解释. 在这一章里面, 我们将处理设置项目和开发环境的问题, 因此一旦我们掺入一些惊人的代码, 那些问题都可以快速的带过. 你所编写的代码以及如何将它们与你最终的惊人的应用程序联系在一起的问题, 我们将在接下来的几章中讨论.
